# 工作包 04：最終測試與上線部署 (Final Testing & Deployment)

**目標**：確保所有已開發的功能模組能正確地協同工作，並通過使用者驗收測試 (UAT)，最終將穩定、可靠的系統部署到生產環境 (Production)。

---

### Phase 1: 端對端整合測試 (End-to-End Testing)

此階段的目標是模擬真實使用者的操作情境，驗證整個系統的完整流程。

- [ ] **測試案例設計**：
    - [ ] 根據 `requirements.md`，設計涵蓋主要使用者旅程 (User Journey) 的 E2E 測試案例。
    - [ ] **範例 1 (AI 問答)**：使用者從 LINE 發問 -> 協同器判斷 -> 查詢 Kendra/RDS -> 生成答案 -> 使用者收到回覆。
    - [ ] **範例 2 (維修申請)**：使用者從 LIFF 提交表單 -> 訂單 Lambda 處理 -> 呼叫 ERP 適配器 -> 資料庫記錄 -> LIFF 收到維修碼。
    - [ ] **範例 3 (廠商查詢)**：廠商從 LINE 登入 -> 廠商 Lambda 驗證 -> 呼叫 ERP 適配器 -> 使用者收到訂單列表。
- [ ] **測試環境準備**：
    - [ ] 建立一個獨立的「測試 (Staging)」環境，其架構應與生產環境完全一致。
    - [ ] 準備好 E2E 測試所需的帳號（LINE 測試帳號、廠商測試帳號）與資料。
- [ ] **執行測試**：
    - [ ] 根據設計好的測試案例，手動或透過自動化腳本執行測試。
    - [ ] 記錄所有發現的缺陷 (Defects) 到問題追蹤系統 (Issue Tracking System)。

### Phase 2: 使用者驗收測試 (UAT)

- [ ] **UAT 準備**：
    - [ ] 與客戶溝通，確認 UAT 的範圍、標準與參與人員。
    - [ ] 準備一份清晰的 UAT 測試腳本與操作指南，供客戶使用。
- [ ] **執行 UAT**：
    - [ ] 在 Staging 環境中，由客戶方的最終使用者進行測試。
    - [ ] 安排至少一場 UAT 會議，即時解答客戶問題並記錄回饋。
- [ ] **回饋處理**：
    - [ ] 收集並整理所有 UAT 的問題與修改建議。
    - [ ] 與客戶確認問題的優先級，並安排開發資源進行修正。

### Phase 3: 生產環境部署準備 (Production Readiness)

- [ ] **程式碼凍結 (Code Freeze)**：
    - [ ] 在指定時間點後，除了緊急的 Bug 修復外，不再將任何新功能合併到主分支。
- [ ] **生產環境配置**：
    - [ ] 準備一份獨立的 `samconfig-prod.toml` 部署設定檔。
    - [ ] 再次確認 `template.yaml` 中所有生產環境參數（例如，RDS 實例大小、Kendra 版本、Lambda 內存）皆已設定為正式規格。
- [ ] **最終部署計畫**：
    - [ ] 與所有利害關係人 (stakeholders) 確認最終的生產環境部署時程（建議在離峰時段）。
    - [ ] 擬定詳細的部署計畫與 Rollback (回滾) 預案。

### Phase 4: 生產環境部署 (Production Deployment)

- [ ] **執行部署**：
    - [ ] 在預定時間，執行 `sam deploy` 指令，並指定使用生產環境的設定檔。
- [ ] **部署後驗證 (Post-Deployment Verification)**：
    - [ ] 部署完成後，由開發團隊立即進行一輪快速的煙霧測試，確保核心功能運作正常。
    - [ ] 檢查 CloudWatch Logs 和 Alarms，確認沒有非預期的錯誤發生。

### Phase 5: 上線後監控 (Post-Launch Monitoring)

- [ ] **密集監控期**：
    - [ ] 系統上線後的初期（例如：前 72 小時），維運與開發團隊需密切監控 CloudWatch Dashboard 上的各項指標。
- [ ] **交付維運**：
    - [ ] 確認系統穩定運作後，將監控責任正式移交給維運團隊。
    - [ ] 確保 `ops_guide.md` 文件已包含所有必要的維運資訊。
